<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Research – The Fay Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./teaching.html" rel="next">
<link href="./people.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c16d2075821f60783b9dd602420178f9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./research.html">Research</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/thefaylab_hex.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./images/thefaylab_hex.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://thefaylab.com" title="thefaylab.com" class="quarto-navigation-tool px-1" aria-label="thefaylab.com"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/thefaylab" title="FayLab Github" class="quarto-navigation-tool px-1" aria-label="FayLab Github"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./people.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">People</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Research</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./teaching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teaching</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./publications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blog</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jointhelab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Opportunities</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research" id="toc-research" class="nav-link active" data-scroll-target="#research">Research</a>
  <ul class="collapse">
  <li><a href="#research-themes" id="toc-research-themes" class="nav-link" data-scroll-target="#research-themes">Research themes</a></li>
  <li><a href="#sources-of-funding-2014-present-including-from-gf-private-consulting" id="toc-sources-of-funding-2014-present-including-from-gf-private-consulting" class="nav-link" data-scroll-target="#sources-of-funding-2014-present-including-from-gf-private-consulting">Sources of funding (2014-present, including from GF private consulting)</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/thefaylab/thefaylab.github.io/edit/main/research.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/thefaylab/thefaylab.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Research</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="research" class="level2">
<h2 class="anchored" data-anchor-id="research">Research</h2>
<p>Our research focuses on developing and testing quantitative modeling tools used for assessment and management of living marine resources, working to advance sustainable decision-making for our oceans and the people who depend on them in a changing world. We focus on decision support tools applied to management of fish, marine mammal, and reptile populations, regionally in the Northeast and Mid-Atlantic of the USA, as well as elsewhere nationally and internationally. A central theme is considering the performance of methods used for management given an ecosystem and socio-ecological systems perspective. We use ecosystem and population modeling to test the performance of fishery- and ecosystem-based management strategies and evaluate the robustness of management options to a range of system uncertainty, including climate change. To achieve these goals, we make use of and develop methods for stock and ecosystem assessment, and employ simulation frameworks including Management Strategy Evaluation. To support Integrated Ecosystem Assessment, we are increasingly working across disciplines to integrate dynamics of the human dimension into evaluation of management consequences of choices for human uses of the marine ecosystem.</p>
<p>We embrace principles and workflows from open data science to help make our work more shareable, accessible, and reproducible. Common to all our work is an applied approach to improve the advice for science-based decision-making by living resource management agencies; quantitative models and methods like MSE provide a transparent and explicit approach for quantifying tradeoffs among management objectives, often merely implicit in decision-making. Developing effective methods for visualizing and communicating these tradeoffs and management outcomes is an additional area of focus. We collaborate with scientists at state and federal agencies, international science organizations, and with regional fisheries management organizations. Graduate students in our lab all work closely with scientists at NOAA National Marine Fisheries Service, in Population Dynamics, Ecosystem Dynamics and Assessment, Surveys, and Protected Species.</p>
<p>Current and recent research topics include:</p>
<ul>
<li><p>Using ecosystem models to test the performance of ecosystem-based fisheries management strategies in the Northeast US</p></li>
<li><p>Developing methods for managing New England groundfish fisheries under a changing climate</p></li>
<li><p>Assessing economic effects of fishing scenarios through ecological-economic model coupling</p></li>
<li><p>Evaluating performance of adaptations to scientific surveys due to spatial overlap with offshore wind installation areas</p></li>
<li><p>Ecosystem indicators as operational tools for fisheries management</p></li>
<li><p>Management of recreational fishery for summer flounder</p></li>
<li><p>Developing and testing spatial stock assessment models</p></li>
<li><p>Integrating telemetry information into assessment models for highly migratory species</p></li>
<li><p>Decision support tools for Integrated Ecosystem Assessment and Ecosystem-Based Management</p></li>
<li><p>Multispecies stock assessment models</p></li>
</ul>
<section id="research-themes" class="level3">
<h3 class="anchored" data-anchor-id="research-themes">Research themes</h3>
<section id="evaluating-ecosystem-based-fisheries-management-procedures" class="level4">
<h4 class="anchored" data-anchor-id="evaluating-ecosystem-based-fisheries-management-procedures">Evaluating ecosystem-based fisheries management procedures</h4>
<p>To operationalize ecosystem-based fisheries management, there needs to be well-tested on-ramps for including or accounting for ecosystem information in fisheries decisions, as well as understanding the performance of advice for management that includes (or doesn’t include) this information, including in the context of climate change. We have developed methods and frameworks to estimate and assess the importance of thresholds in indicators of ecosystem state given both human and environmental stressors. We tested the performance of management strategies that include fishery control rules which use the status of ecosystem indicators relative to ecosystem reference points to modify fishing mortality among species for a Georges Bank finfish community case study, and demonstrated that in some cases it is possible to improve against both economic and conservation objectives by including these indicators in decisions (see also Gaichas et al.&nbsp;2017). Further work suggested that placing ceilings on system removals can also be a leading driver of multispecies fishery performance without the need for multispecies stock assessment models. Ongoing work is investigating how technical interactions and other constraints associated with the operation and management of multispecies fisheries affect the performance of these ecosystem approaches. With Dr.&nbsp;Lisa Kerr’s lab at Gulf of Maine Research Institute, we are also testing the performance of climate responsive management options for New England groundfish, and conducting a series of meetings with regional decision makers and stakeholders aimed at education around EBFM and benefits of management strategy evaluation for strategic decision-making in fisheries. Our work demonstrates how ecosystem indicator information could be used within current fisheries management frameworks. These results (along with others) form the basis for possible decision points in an example Fishery Ecosystem Plan under consideration for New England.</p>
</section>
<section id="ecosystem-models-to-assess-socio-ecological-system-outcomes" class="level4">
<h4 class="anchored" data-anchor-id="ecosystem-models-to-assess-socio-ecological-system-outcomes">Ecosystem models to assess socio-ecological system outcomes</h4>
<p>Ecosystem models, including whole-of-system or end-to-end models, enable tradeoffs to be quantified for a broader suite of societal and ecological objectives, allowing a more systemic look at possible outcomes for strategic management choices and uncertainties associated with forecasts. We have coupled regional economic models with the output of the ecosystem model Atlantis to calculate indicators associated with the effects of fishing strategies on jobs and earnings in the Northeast region as a whole as well as on seafood supply. We have also used these whole-of-system models to quantify plausible consequences of ocean acidification, and compare among marine ecosystems broad ecological and fishery outcomes of implementing Marine Protected Areas as part of management solutions in addition to different levels of fishing mortality and climate effects. While whole-of-system models can provide complex characterizations of coupled socio-ecological marine systems, they require data and resources, and may not be easy to fully evaluate implication of modeling choices. Qualitative and semi-quantitative models that characterize linkages within systems but do not rely on mechanistic models for dynamics of system components could be useful tools for integrating across human, physical, and ecological components of ecosystems, and for rapidly screening environmental and human use scenarios. Wildermuth et al.&nbsp;(2018) created a qualitative model for the Georges Bank socio-ecological system and evaluated how the ability to meet management objectives changed with alternatives for model structure. Our ongoing work as part of the ICES Working Group for the Northwest Atlantic Regional Sea (WGNARS) is evaluating what the role of these (and other) tools can be in the Integrated Ecosystem Assessment process (e.g.&nbsp;DePiper et al.&nbsp;2017, WGNARS 2018; Wildermuth PhD thesis), developing best practices that are being incorporated in to the broader NOAA IEA program, being used by the Mid-Atlantic Fishery Management Council as part of their Ecosystem Approach to Fisheries, and also within the larger ICES community.</p>
<p>Challenges facing marine fisheries also include interactions with other marine uses, including the rapid increase of offshore wind energy. Development of offshore wind industry on the US east coast creates spatial overlap with installation areas and fisheries operations, and also requires adaptation to scientific monitoring to maintain data streams for fisheries and ecosystems used as the basis for fisheries management advice. As part of an interagency agreement between BOEM and NOAA Fisheries, we are using spatially explicit ecosystem modeling to test the effect of changes to scientific surveys as a result of spatial overlap with wind lease areas and evaluating the efficacy of supplemental monitoring strategies for data used in fisheries assessment models and management advice.</p>
</section>
<section id="integrated-population-modeling" class="level4">
<h4 class="anchored" data-anchor-id="integrated-population-modeling">Integrated population modeling</h4>
<p>Scientific advice for tactical fisheries management decisions, such as quota setting, and in-season management adjustments and projections rely on statistical tools for stock assessment and species distribution modeling that can account for ecosystem information and leverage data from multiple sources, including new and developing technologies. A range of data are often collected for highly migratory species of conservation concern (and increasingly for commercial fish too), however these data, such as electronic and acoustic tagging, and photo mark-recapture, are not often directly used with population assessment models. In addition, species distribution modelling approaches that use these data do not fully account for statistical properties of these data resulting in biased inferences. Point process models and integrated population models that take a hierarchical approach to spatial and individual heterogeneity offer feasible solutions for including these data directly in assessment models and species distribution models. We have developed and applied models of this type to estimate loggerhead sea turtle distribution based on satellite tagging, spatial distribution of fish from acoustic tags (Winton et al.&nbsp;2018b), toothed whale distribution in Stellwagen Bank National Marine Sanctuary, and are applying integrated methods to white sharks in Massachusetts (Winton PhD thesis, in prep.) and to multispecies interactions between forage fish and their predators. Our work to develop statistical methods for population assessment has also included evaluating the performance of model selection tools for choosing between stock assessment models that differ in how the environment affects recruitment, important for considering how fisheries productivity may be expected to change in the future. Weston (MS thesis 2018) showed that currently used methods for choosing models are not reliable for distinguishing among these effects yet the consequences of incorrect model choices can be mitigated given adaptive management frameworks with responsive harvest control rules.</p>
<p>Fisheries are rarely prosecuted on a species-by-species basis. However, examples of integrated population models that account for process error and observation error of multiple data types and take a multispecies approach are limited. In Trijoulet et al.&nbsp;(2019) and Trijoulet et al.&nbsp;(2020) we developed a new multispecies state-space stock assessment model and tested its performance for assessing fisheries dynamics, evaluating the treatment of diet data along with more traditional stock assessment data sources in estimation bias. We are currently also expanding the capabilities of the length-based statistical multispecies fisheries model Hydra (Gaichas et al.&nbsp;2017) for application to multispecies fisheries in the Norwegian and Barents Sea, and Georges Bank, including simulation testing using output from the Atlantis ecosystem model as a virtual laboratory. This work adds to the suite of modeling tools available for assessing the status of fisheries in New England and beyond, and a common approach across projects is to evaluate and compare the performance of new methods to current approaches using simulation testing.</p>
</section>
</section>
<section id="sources-of-funding-2014-present-including-from-gf-private-consulting" class="level3">
<h3 class="anchored" data-anchor-id="sources-of-funding-2014-present-including-from-gf-private-consulting">Sources of funding (2014-present, including from GF private consulting)</h3>
<ul>
<li>Atlantic States Marine Fisheries Commission</li>
<li>Boston Scientific Foundation</li>
<li>California Ocean Science Trust</li>
<li>Cooperative Institute for the North Atlantic Region (CINAR)</li>
<li>Department of Energy</li>
<li>Gulf of Maine Research Institute</li>
<li>International Council for the Exploration of the Sea (ICES)</li>
<li>Massachusetts Clean Energy Center</li>
<li>Massachusetts Division of Marine Fisheries</li>
<li>Mid-Atlantic Fishery Management Council</li>
<li>MIT Sea Grant</li>
<li>National Center for Ecological Analysis &amp; Synthesis, UC Santa Barbara</li>
<li>National Science Foundation</li>
<li>New England Fishery Management Council</li>
<li>NOAA Climate Program Office</li>
<li>NOAA Fisheries &amp; the Environment (FATE)</li>
<li>NOAA Fisheries Stock Assessment Analytical Methods</li>
<li>NOAA Fisheries Office of Science and Technology</li>
<li>NOAA Fisheries Quantitative Ecology and Socioeconomics Training Program (QUEST)</li>
<li>NOAA Northeast Fisheries Science Center</li>
<li>NOAA Office of National Marine Sanctuaries</li>
<li>NOAA Saltonstall Kennedy</li>
<li>NOAA Sea Grant</li>
<li>Science Center for Marine Fisheries, University of Southern Mississippi</li>
<li>Sound Resolutions LLC</li>
<li>The Nature Conservancy</li>
<li>University of Massachusetts Dartmouth Blue Economy</li>
<li>University of Massachusetts Dartmouth Marine &amp; Undersea Science Technology Program (MUST)</li>
<li>Virginia Institute of Marine Sciences</li>
<li>Virginia Polytechnic Institute &amp; State University</li>
<li>Woods Hole Oceanographic Institution</li>
<li>Woods Hole Sea Grant</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/thefaylab\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./people.html" class="pagination-link" aria-label="People">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">People</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./teaching.html" class="pagination-link" aria-label="Teaching">
        <span class="nav-page-text">Teaching</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© CC-By FayLab 2025, Openscapes 2024</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/thefaylab/thefaylab.github.io/edit/main/research.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/thefaylab/thefaylab.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>